@model Coffee.Models.User

@{
    ViewBag.Title = "Chỉnh sửa người dùng";
}

<h2 class="mb-4"><i class="fas fa-user-edit"></i> Chỉnh sửa Người Dùng</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="card shadow p-4 mb-4">
        <h4 class="mb-3"><i class="fas fa-user-cog"></i> Thông tin người dùng</h4>
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.UserID)

        <div class="form-group mb-3">
            @Html.Label("Tên đăng nhập")
            @Html.TextBoxFor(model => model.Username, new { @class = "form-control", placeholder = "Nhập tên đăng nhập" })
            @Html.ValidationMessageFor(model => model.Username, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Mật khẩu")
            @Html.PasswordFor(model => model.PasswordHash, new { @class = "form-control", placeholder = "Nhập mật khẩu mới (nếu thay đổi)" })
            @Html.ValidationMessageFor(model => model.PasswordHash, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Vai trò")
            @Html.TextBoxFor(model => model.Role, new { @class = "form-control", placeholder = "admin, user, ..." })
            @Html.ValidationMessageFor(model => model.Role, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Email")
            @Html.TextBoxFor(model => model.Email, new { @class = "form-control", placeholder = "Nhập địa chỉ email" })
            @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Họ và tên")
            @Html.TextBoxFor(model => model.FullName, new { @class = "form-control", placeholder = "Nhập họ tên đầy đủ" })
            @Html.ValidationMessageFor(model => model.FullName, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Số điện thoại")
            @Html.TextBoxFor(model => model.Phone, new { @class = "form-control", placeholder = "Nhập số điện thoại" })
            @Html.ValidationMessageFor(model => model.Phone, "", new { @class = "text-danger" })
        </div>

        <div class="form-group mb-3">
            @Html.Label("Link ảnh đại diện")
            @Html.TextBoxFor(model => model.Avatar, new { @class = "form-control", placeholder = "Dán link ảnh đại diện", id = "avatarInput" })
            @Html.ValidationMessageFor(model => model.Avatar, "", new { @class = "text-danger" })

            <div class="mt-2">
                <img id="avatarPreview" src="@Model.Avatar" alt="Ảnh đại diện" class="img-thumbnail" style="max-height:100px;" />
            </div>
        </div>

        <div class="form-group mb-3">
            @Html.Label("Địa chỉ")
            @Html.TextBoxFor(model => model.Address, new { @class = "form-control", placeholder = "Nhập địa chỉ" })
            @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
        </div>

        <div class="form-group text-end mt-4">
            <input type="submit" value="💾 Lưu thay đổi" class="btn btn-primary" />
            @Html.ActionLink("← Quay lại danh sách", "Index", null, new { @class = "btn btn-secondary ms-2" })
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        // Hiển thị ảnh đại diện ngay khi nhập link
        document.getElementById("avatarInput").addEventListener("input", function () {
            document.getElementById("avatarPreview").src = this.value;
        });
    </script>
}
